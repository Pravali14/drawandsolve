o
    â€°Æ’Â¸fâ€¦  Ã£                   @   s\   d dl Z d dlZd dlZd dlmZ d dlm Z  G ddâ€ dÆ’Ze	dkr,eÆ’ Z
e
Â 
Â¡  dS dS ) Ã©    N)ÃšHandDetector)ÃšposeDetectorc                   @   sV   e Zd Zddâ€ Zddâ€ Zddâ€ Zd dâ€ Zd	d
â€ Z d
dâ€ Zd
dâ€ Z	ddâ€ Z
dddâ€Z
dS )ÃšArmCurlsCounterc                 C   sâ€    t Â dÂ¡| _| jÂ ddÂ¡ | jÂ ddÂ¡ tÆ’ | _d| _d| _ d| _t	Æ’ | _
d| _
d d dd	d
Å“| _d
d dd	d
Å“| _
d| _d| _d
| _d S )Nr   Ã©   i   Ã©   Ã©Ã  ÃšrightÃ©2   Ã©Ãˆ   Ã©d   )Ãšx1Ãšy1Ãšx2Ãšy2Ã©Ãº   iÂ  g      Ã°?)Ãšcv2ÃšVideoCaptureÃšcapÃšsetr   ÃšdetectorÃšcountÃšdirÃšpTimer   Ãšhands_DetectorÃš
active_armÃš
button_leftÃšbutton_rightÃšfÃšlast_switch_timeÃšswitch_delay)ÃšselfÂ© r!   Ãº\C:\Users\bhush\OneDrive\Desktop\PAVAN\Projects\CV_Desktop\Fitness_Tracker\fitness_tracker.pyÃš__init__   s   
zArmCurlsCounter.__init__c           
      C   sÂ¦   | j Â |dÂ¡}| j Â |dÂ¡}t|Æ’dkrQ| jdkr(d\}}}| j Â ||||Â¡}nd\}}}| j Â ||||Â¡}tÂ  |dd Â¡} tÂ  |dd	Â¡}| Â | Â¡}	| Â 	|| ||	Â¡ |S )
NFr   r   )Ã©   Ã©
   Ã©
   )Ã©   Ã©   Ã©   )Ã©Ã’   Ã©6  )r   r
   )Ã©Ãœ   r+   )Ã©Å   r
   )
r   ZfindPoseÃšfindPositionÃšlenr   Ãš	findAngleÃšnpÃšinterpÃšupdate_countÃš draw_ui)
r    ÃšimgÃšlmListZshoulderZelbowZwristÃšangleÃšperÃšbarÃšcolorr!   r!   r"   Ãš
process_frame   s   



zArmCurlsCounter.process_framec                 C   s\   d}|dkrd}| j dkr|  jd7  _d| _ |dkr,d}| j dkr,|  jd7  _d| _ |S ) N)Ã©Ã¿   r   r<   r
   Â©r   r<   r   r   g      Ã ?Ã©   )r   r   )r    r8   r:   r!   r!   r"   r3   (   s   

zArmCurlsCounter.update_countc              	   C   s  t Â |ddddÂ¡ t Â |dt|Æ’fd|t jÂ¡ t Â |t|Æ’â€º dÂd t jd|d	Â¡  t Â |d
d
dt jÂ¡ t Â |tt| j Æ’Æ’d
t jdddÂ¡  t Â |ddt jdddÂ¡  | Â || j	d| j
dkÂ¡ | Â || j
d| j
dkÂ¡ tÂ Â¡ | j
 | jk rt Â |ddt jddd	Â¡  d S d S )N)Ã©L  r
   )iâ€”  r-   Â©r
   r
   r
   r   r?   Ãº%)i`  Ã©K   r>   Ã©   )r   iÃ‚  )r   r    )Ã©Ãµ   Ã©u   r)   )Ã©-   iÅ¾  Â©r<   r<   r<   Ã©   ZREPS)Ã©(   i0  g      Ã¸?Ã©   zLeft ArmÃšleftz	Right Armr   zSwitching...)iÃ´  r	   )r   r   r<   )r   Ãš	rectangleÃšintÃšFILLEDÃš putTextÃšFONT_HERSHEY_SIMPLEXÃšstrr   Ãš
draw_buttonr   r   r   Ãštimer   r   )r    r5   r8   r9   r:   r!   r!   r"   r4   6   s   ""Ã¿zArmCurlsCounter.draw_uic              	   C   sh   |rdnd}t Â ||d |d f|d |d f|t jÂ¡ t Â |||d d  |d d ft jd	d
d
Â¡  d S )Nr=   r@   r   r
   r   r   Ã©
   Ã©#   Ã§ffffffÃ¦?Â©r   r   r   rC   )r   rL   rN   rO   rP   )r    r5   ÃšbuttonÃštextÃš	is_activer:   r!   r!   r"   rR   H   s   ,0zArmCurlsCounter.draw_buttonc              	   C   sB   t Â  Â¡ }d|| j  }|| _tÂ |dt|Æ’â€º ÂdtjdddÂ¡  |S )Nr>   zFPS: )r?   r	   rG   rC   )rS   r   r   rO   rM   rP   )r    r5   ÃšcTimeÃšfpsr!   r!   r"   Ãšshow_fpsM   s
   "zArmCurlsCounter.show_fpsc                 C   sr  t Â  Â¡ }d}| jd |d d   k r| jd k r5n n| jd |d d    k r0| jd k r5n nd	}n=| jd |d d   k rI| jd k rdn n| jd |d d    k r_| jd k rdn nd	}n|g d
Â¢ksp|g d
Â¢krrd	}|râ€™|| j | jkrâ€™|  jd7  _|| _| jd  rÂd| _nd
| _d|d d   k rÂ dk rÂµn d S d|d d    k rÂ²dk rÂ·dS  d S d S d S )NFr   Ã©   r>   r   r
   rC   r   T)r>   r   r   r   r>   )r   r   r   r   r>   rK   r   Ã©â€  Ã©Ã¨  r	   Ã©Z   ) rS   r   r   r   r   r   r   )r    ÃšlmlistÃš fingersÃšcurrent_timeZ
switch_armr!   r!   r"   Ãšhandle_clickT   s"   XX
<Ã¿zArmCurlsCounter.handle_clickc              	   C   sâ€   t Â |||ddÂ¡ t Â |||ddÂ¡ |d d |d  d f}t Â |||t jd	ddÂ¡  t Â |||d d |d  d ft jd	d
dÂ¡  |S )
Nr=   Ã©Ã¿Ã¿Ã¿Ã¿rW   rC   r   rT   r>   Ã©   rV   rG   )r   rL   rO   rP   )r    ÃšimageÃštop_leftÃšbottom_rightrY   Ãš
text_positionr!   r!   r"   Ãšdraw_rectangle_with_textj   s   $Ã¿z(ArmCurlsCounter.draw_rectangle_with_textNc                  C   sÃœ   |r|| _ tÂ dÂ¡ 	 | j Â Â¡ \}}|sqhtÂ |dÂ¡}| jj|dddÂ\}}|rC| jÂ  |Â¡}|rC| jÂ |d Â¡}| Â 	||Â¡rCtÂ 
Â¡  qh| Â 
|Â¡}| Â |Â¡}| Â 
|d dd	Â¡}tÂ d|Â¡ tÂ dÂ¡d
@ td
Æ’krgqhq
tÂ 
Â¡  d S )NzArm Curls CounterTr>   F)ÃšdrawÃšflipTyper   )r_   r	   )r`   ra   ÃšBACKr<   Ãšq)r   r   Ãš
namedWindowÃšreadÃšflipr   Ãš	findHandsr.   Ãš	fingersUpre   ÃšdestroyAllWindowsr;   r]   rl   ÃšimshowÃš waitKeyÃšord) r    ÃšcamÃš successr5   Ãšhandsrb   rc   r!   r!   r"   Ãšrun{   s0   


Ã®zArmCurlsCounter.run)N)Ãš__name__Ãš
__module__Ãš__qualname__r#   r;   r3   r4   rR   r]   re   rl   r}   r!   r!   r!   r"   r       s     r   Ãš__main__)r   Ãšnumpyr1   rS   ÃšHandsGestureDetectorr   ZFitness_Tracker.PoseModuler   r   r~   Zarm_curls_counterr}   r!   r!   r!   r"   Ãš<module>   s     Ã¾
